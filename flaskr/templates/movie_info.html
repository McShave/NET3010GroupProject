{% extends 'base.html' %}

{% block title %}- Movie Info{% endblock %}
{% block header %}
<a class="logo" href="{{ url_for('index') }}"><img src="{{ url_for('static', filename='images/logo_2.png') }}" alt="Flashback Logo" height="80"></a> 
{% endblock %}

{% set moviedetails = details["details"] %}
{% set moviecast = details["cast"] %}
{% set moviecrew = details["crew"] %}


{% block content %}
<!-- <div id="detail" style="background-image: url(&quot;https://yts.mx/assets/images/movies/The_Shawshank_Redemption_1994/background.jpg&quot;);"> -->
<div id="detail">
    <div id="container">
        <h2 id="title">{{ moviedetails["name"] }}</h2> 
        <div id="description">
            <img src="{{moviedetails['pathtoposter']}}" id="des_img">
            <div id="mini">
                <span>Release</span><br>    
                <h4>{{moviedetails["releaseDate"] }}</h4><br>
                <span>Tagline</span><br>
                <h4><span> {{ moviedetails["tagline"] }}</h4><br>

                <span>Summary</span> 
                    <h4><p id="detail_des">
                        {{ moviedetails["summary"] }}</p></h4><br>

                <span>Review and Ratings</span> <br>
            <div>
            {% if g.user %}
            <form id="moviereview" type="review" name="movieReview" onsubmit="return validateReviewForm()" method="post"  autocomplete="off">
            <label><b>Leave a Review and your Score</b></label>
            <textarea id="review-box" name="review-box" placeholder="Leave a Review"></textarea>
            <select id="review-score" name="review-score">
                <option value="zero">0</option>
                <option value="one">1</option>
                <option value="two">2</option>
                <option value="three">3</option>
                <option value="four">4</option>
                <option value="five">5</option>
                <option value="six">6</option>
                <option value="seven">7</option>
                <option value="eight">8</option>
                <option value="nine">9</option>
                <option value="ten">10</option>
            </select>
            <input class="userButton" type="submit" value="Enter"></input>
            </form>
            
            <script>
            function validateReviewForm() {
            let reviewText = document.forms["movieReview"]["review-box"].value;
            let reviewScore = document.forms["movieReview"]["review-score"].value;
            if (x == "" && reviewScore == "zero") {
              alert("Leave a review or score.");
              return false;
            }
            } 
            </script>

    {% else %}
        <p><a class="userButton" href="{{url_for('auth.login')}}">Login to leave a review</a></p><br>
        
    {% endif %}
    {% if not reviews %}
        <p>There are no reviews</p>
    {% else %}
        <p>‚≠ê Movie Score: {{reviews["score"]}}</p>
        <button class="userButton" onclick="hideReviews()">Reviews</button><br>
        <div id="reviewContent" style="display: none">
        <p>Reviews:</p>
        {% for review in reviews["reviews"] %}
            <p>{{ review[0] }}: ({{review[2]}}) {{ review[1] }}</p>
        {% endfor %}
        </div>
    {% endif %}<br>

    <button class="userButton" onclick="hideCast()">Cast</button>
    <div id="castContent" style="display: none"><br>
        {% for actor in moviecast %}
            <p>
                {% if 'https://' in actor['pathtopicture'] %}
                    <img class="person__img" src="{{ actor['pathtopicture']}}" alt="{{actor['name']}} poster" style="width: 100%; max-width: 100px">
                    {% else %} <span>  (No Image)  </span>
                {% endif %}
                <b><a href="{{url_for('person_info', id=actor['personID']) }}">{{actor["name"]}} - {{actor["character"]}}</a></b>
            </p>
        {% endfor %}
    </div>
    <button class="userButton" onclick="hideCrew()" >Crew</button>
    <div id="crewContent" style="display: none"><br>
        {% for crew in moviecrew %}
            <p>
                {% if 'https://' in crew['pathtopicture'] %}
                    <img class="person__img" src="{{ crew['pathtopicture']}}" alt="{{crew['name']}} poster" style="width: 100%; max-width: 100px;">
                    {% else %} <span>  (No Image)  </span>
                {% endif %}
                <b><a href="{{url_for('person_info', id=crew['personID']) }}">{{crew["name"]}} - {{crew["role"]}}</a></b>
            </p>
        {% endfor %}
    </div>
            </div>
    
            </div>
        </div>
    </div>
</div>
    
    <script>
        function hideCast() {
            var x = document.getElementById("castContent");
            if (x.style.display === "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        }
        function hideCrew() {
            var x = document.getElementById("crewContent");
            if (x.style.display === "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        } 
        function hideReviews() {
            var x = document.getElementById("reviewContent");
            if (x.style.display === "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        } 
    </script> 
{% endblock %}

